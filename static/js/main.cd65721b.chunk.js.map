{"version":3,"sources":["SelectionContainer.js","App.js","index.js"],"names":["SelectionContainer","props","react_default","a","createElement","className","class","href","MAPBOX_ACCESS_TOKEN","initialView","longitude","latitude","zoom","App","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","_onWebGLInitialized","gl","setState","_onMapLoad","map","_map","deck","_deck","addLayer","MapboxLayer","id","state","_onViewStateChange","bind","assertThisInitialized","viewState","_ref","_this2","TileLayer","type","getTileData","_ref2","x","y","z","mapSource","concat","fetch","then","response","arrayBuffer","buffer","features","vectorTileLayer","VectorTile","Protobuf","layers","i","length","feature","toGeoJSON","push","onTileError","e","console","error","maxZoom","onHover","info","hoveredObject","object","pointerX","pointerY","renderSubLayers","ScatterplotLayer","opacity","pickable","getLineWidth","radiusScale","Math","pow","max","radiusMinPixels","radiusMaxPixels","getPosition","d","geometry","coordinates","getFillColor","getRadius","sqrt","properties","NR_ASSESSED_VALUE","_ref3","style","position","zIndex","pointerEvents","left","top","toLocaleString","ADDRESS","_this3","deckgl","ref","_renderLayers","initialViewState","controller","onWebGLInitialized","onViewStateChange","esm","getMap","mapStyle","mapboxApiAccessToken","onLoad","_renderTooltip","src_SelectionContainer","React","Component","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.cd65721b.chunk.js","sourcesContent":["import React from \"react\"\n\nfunction SelectionContainer(props) {\n  return (\n    <div>\n      <div className='absolute top left w360 h240 py12 px12 ml36 mt36 bg-white round-bold prose'>\n      <h4>City of Calgary <span class='txt-underline'>Non-Residential Property Assessment</span></h4>\n        <div class='w300 round shadow-darken10 px6 py6 txt-s mt12'>\n          <strong class='block mb6'>Non-Residental Assessment Value</strong>\n          <div class='flex-parent flex-parent--center-main flex-parent--center-cross align-center'>\n            <div class='flex-child flex-child--grow wmin24'>\n              <span class='inline-block w3 h3 round-full bg-blue'></span>\n            </div>\n            <div class='flex-child flex-child--grow wmin24'>\n              <span class='inline-block w6 h6 round-full bg-blue'></span>\n            </div>\n            <div class='flex-child flex-child--grow wmin24'>\n              <span class='inline-block w12 h12 round-full bg-blue'></span>\n            </div>\n            <div class='flex-child flex-child--grow wmin24'>\n              <span class='inline-block w18 h18 round-full bg-blue'></span>\n            </div>\n            <div class='flex-child flex-child--grow wmin24'>\n              <span class='inline-block w36 h36 round-full bg-blue'></span>\n            </div>\n            <div class='flex-child flex-child--grow wmin24'>\n              <span class='inline-block w60 h60 round-full bg-blue'></span>\n            </div>\n          </div>\n          <div class='grid txt-xs align-center'>\n            <div class='col wmin24'>$1 Million</div>\n            <div class='col wmin24'></div>\n            <div class='col wmin24'></div>\n            <div class='col wmin24'></div>\n            <div class='col wmin24'></div>\n            <div class='col wmin24'>$1 Billion</div>\n          </div>\n        </div>\n        <div class=\"txt-s mt12\"><a href=\"https://saadiqm.com/deck-gl-assessment-map-re/\">Link</a> to Residental Property assessment map</div>\n      </div>\n    </div>\n  )\n}\n\n\nexport default SelectionContainer\n","import React from 'react';\nimport DeckGL from '@deck.gl/react';\nimport {MapboxLayer} from \"@deck.gl/mapbox\";\nimport {StaticMap} from 'react-map-gl';\nimport {TileLayer} from '@deck.gl/geo-layers';\nimport {VectorTile} from '@mapbox/vector-tile';\nimport Protobuf from 'pbf';\nimport {ScatterplotLayer} from '@deck.gl/layers';\n\nimport SelectionContainer from \"./SelectionContainer\"\n\nconst MAPBOX_ACCESS_TOKEN = 'pk.eyJ1Ijoic2FhZGlxbSIsImEiOiJjamJpMXcxa3AyMG9zMzNyNmdxNDlneGRvIn0.wjlI8r1S_-xxtq2d-W5qPA';\n\nconst initialView = {\n  longitude: -114.062019,\n  latitude: 51.044270,\n  zoom:10.5,\n};\n\nclass App extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      zoom:initialView.zoom,\n    };\n    this._onViewStateChange = this._onViewStateChange.bind(this);\n  }\n\n  _onWebGLInitialized = (gl) => {\n    this.setState({gl});\n  }\n\n  _onMapLoad = () => {\n    const map = this._map;\n    const deck = this._deck;\n\n    let name = \"assessment-NR\"\n    map.addLayer(new MapboxLayer({id: name, deck}),'waterway-label');\n  }\n\n  _onViewStateChange({viewState}) {\n    this.setState({zoom:viewState.zoom});\n  }\n\n  _renderLayers() {\n\n    const scatter_layer =  new TileLayer({\n      id: \"assessment-NR\",\n      type: TileLayer,\n      getTileData: ({x, y, z}) => {\n        const mapSource = `https://a.tiles.mapbox.com/v4/saadiqm.azk20mv4/${z}/${x}/${y}.vector.pbf?access_token=${MAPBOX_ACCESS_TOKEN}`;\n        return fetch(mapSource)\n          .then(response => response.arrayBuffer())\n          .then(buffer => {\n            const tile = new VectorTile(new Protobuf(buffer));\n\n            const features = [];\n            let vectorTileLayer = tile.layers[\"NR\"]\n\n            for (let i = 0; i < vectorTileLayer.length; i++) {\n              const vectorTileFeature = vectorTileLayer.feature(i);\n              const feature = vectorTileFeature.toGeoJSON(x, y, z);\n              features.push(feature);\n            }\n            return features;\n          });\n      },\n      onTileError:(e) => console.error(e),\n      maxZoom:14,\n      onHover: info => this.setState({\n       hoveredObject: info.object,\n       pointerX: info.x,\n       pointerY: info.y\n      }),\n      renderSubLayers: props => {\n        return new ScatterplotLayer(props,{\n            opacity:0.5,\n            pickable: true,\n            getLineWidth:0,\n            radiusScale: Math.pow(2, Math.max(14 - this.state.zoom, 0)),\n            radiusMinPixels: 1,\n            radiusMaxPixels:90,\n            getPosition: d => d.geometry.coordinates,\n            getFillColor: d => [66, 135, 245],\n            getRadius: d => Math.sqrt(d.properties.NR_ASSESSED_VALUE)/500,\n          });\n        }\n      })\n\n    return [scatter_layer]\n  }\n\n  _renderTooltip() {\n    const {hoveredObject, pointerX, pointerY} = this.state || {};\n    return hoveredObject && (\n      <div style={{position: 'absolute', zIndex: 1, pointerEvents: 'none', left: pointerX, top: pointerY}} className=\"bg-lighten75 py6 px12\">\n        <p className=\"txt-bold\">{\"$\"+hoveredObject.properties['NR_ASSESSED_VALUE'].toLocaleString()}</p>\n        <p className=\"txt-s\">{hoveredObject.properties.ADDRESS}</p>\n      </div>\n    );\n  }\n\n  render() {\n\n    const {gl} = this.state;\n\n    return (\n      <div>\n      <DeckGL\n        ref={ref => {\n          this._deck = ref && ref.deck;\n        }}\n        layers={this._renderLayers()}\n        initialViewState={initialView}\n        controller={true}\n        onWebGLInitialized={this._onWebGLInitialized}\n        onViewStateChange={this._onViewStateChange}\n\n      >\n      {gl && (\n        <StaticMap\n          ref={ref => {\n            this._map = ref && ref.getMap();\n          }}\n          gl={gl}\n          mapStyle=\"mapbox://styles/saadiqm/cjxbd493m05cc1cl29jntlb1w?optimize=true\"\n          mapboxApiAccessToken={MAPBOX_ACCESS_TOKEN}\n          onLoad={this._onMapLoad}\n        />\n      )}\n      {this._renderTooltip()}\n      </DeckGL>\n        <SelectionContainer/>\n      </div>\n\n\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}